<div>
  <span>{{ num }}. Step: {{ stepSignal().eventType }}</span>

  <div class="event-selector">
    <label for="event">Event:</label>
    <select id="event" [(ngModel)]="stepSignal().eventType">
      <option value="Unnamed step" disabled>Select an event</option>

      @for (event of availableEvents; track $index) {
      <option [value]="event">{{ event }}</option>
      }
    </select>
  </div>
  <div>
    @if (stepSignal().eventType !== 'Unnamed step') { @for (filter of stepSignal().filters ??
    [{attribute: '', operator: '', value: ['']}]; track $index) {
    <div>
      <attribute
        [attributes]="propertiesForEvent"
        [selected]="filter?.attribute ?? ''"
        (selectedChange)="updateFilter($index, 'attribute', $event)"
      >
      </attribute>

      <operator
        [type]="filter.type ?? 'string'"
        [selected]="filter.operator"
        (selectedChange)="updateFilter($index, 'operator', $event)"
      >
      </operator>
      @if (filter.operator === 'in between') {
      <input
        type="text"
        [value]="filter.value?.[0] ?? ''"
        (input)="updateFilter($index, 'value', [$event.target.value, filter.value?.[1] ?? ''])"
      />
      and
      <input
        type="text"
        [value]="filter.value?.[1] ?? ''"
        (input)="updateFilter($index, 'value', [filter.value?.[0] ?? '', $event.target.value])"
      />
      } @else {

      <input
        type="text"
        [value]="filter.value?.[0] ?? ''"
        (input)="updateFilter($index, 'value', $event.target.value)"
      />
      } @if ($last === false) {
      <div class="filter-separator">AND</div>
      }
    </div>
    }} @if (stepSignal().filters !== undefined ){
    <a class="refine-link" (click)="addFilter()">Refine more</a> }
  </div>
</div>
